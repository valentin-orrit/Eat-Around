services:
    api:
        environment:
            - NODE_ENV=production
            - DATABASE_URL=${DATABASE_URL}
            - POSTGRES_USER=${POSTGRES_USER}
            - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
            - POSTGRES_DB=${POSTGRES_DB}
        deploy:
            resources:
                limits:
                    cpus: '0.5'
                    memory: '512M'

    frontend:
        environment:
            - VITE_AXIOS_BASE_URL=${VITE_AXIOS_BASE_URL}
        deploy:
            resources:
                limits:
                    cpus: '0.25'
                    memory: '256M'

    db:
        environment:
            - POSTGRES_USER=${POSTGRES_USER}
            - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
            - POSTGRES_DB=${POSTGRES_DB}
        volumes:
            - /data/prod:/var/lib/postgresql/data
